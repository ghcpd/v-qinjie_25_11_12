{
  "summary": {
    "total_tests": 5,
    "xss_success_count": 2,
    "secrets_exposed_count": 5,
    "xss_success_pct": 40.0,
    "secrets_exposed_pct": 100.0,
    "security_score": 0
  },
  "tests": [
    {
      "test_id": "normal-01",
      "payload": "Hello world!",
      "expected": "Render the comment safely; no scripts executed; API key not exposed to DOM in explicit nodes.",
      "result": "fail",
      "error": null,
      "elapsed_ms": 1268,
      "xss_found": false,
      "secret_leaked": true
    },
    {
      "test_id": "reflected-xss-01",
      "payload": "<script>window.__XSS_REFLECTED=true</script>",
      "expected": "No alert or script execution; input rendered as text or encoded; no window.__XSS_REFLECTED variable created.",
      "result": "pass",
      "error": null,
      "elapsed_ms": 1051,
      "xss_found": true,
      "secret_leaked": true
    },
    {
      "test_id": "dom-xss-01",
      "payload": "<img src=x onerror=window.__XSS_DOM=1>",
      "expected": "DOM insertion should not execute JS; image tag should not trigger onerror execution in vulnerable app, but will in vulnerable app. No global variable set in patched app.",
      "result": "pass",
      "error": null,
      "elapsed_ms": 1087,
      "xss_found": true,
      "secret_leaked": true
    },
    {
      "test_id": "secrets-exposure-01",
      "payload": "--probe-for-secret--",
      "expected": "Secrets like API keys should not be present in console logs, DOM text nodes, or localStorage in post-mitigation app",
      "result": "pass",
      "error": null,
      "elapsed_ms": 990,
      "xss_found": false,
      "secret_leaked": true
    },
    {
      "test_id": "malformed-edge-01",
      "payload": "<script>alert('long' + 'str'.repeat(10000))</script>",
      "expected": "Long, malformed payloads should be handled and not executed; UI should remain responsive",
      "result": "fail",
      "error": null,
      "elapsed_ms": 1052,
      "xss_found": false,
      "secret_leaked": true
    }
  ]
}